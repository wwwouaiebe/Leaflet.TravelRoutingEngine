<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>TravelNotes: Source: core/SvgIconFromOsmFactory.js</title>
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
   <!--link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css"-->
    <link type="text/css" rel="stylesheet" href="styles/TravelNotes.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: core/SvgIconFromOsmFactory.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/

This  program is free software;
you can redistribute it and/or modify it under the terms of the
GNU General Public License as published by the Free Software Foundation;
either version 3 of the License, or any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
*/

/*
Changes:
	- v1.4.0:
		- created
	- v1.6.0:
		- Issue #65 : Time to go to ES6 modules?
		- Issue #68 : Review all existing promises.
	- v2.0.0:
		- Issue #135 : Remove innerHTML from code
		- Issue #136 : Remove html entities from js string
		- Issue #138 : Protect the app - control html entries done by user.
		- Issue #145 : Merge svg icon and knoopunt icon
Doc reviewed 20200808
Tests ...
*/

/**
@------------------------------------------------------------------------------------------------------------------------------

@file SvgIconFromOsmFactory.js
@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
@license GNU General Public License
@private

@------------------------------------------------------------------------------------------------------------------------------
*/

/**
@------------------------------------------------------------------------------------------------------------------------------

@typedef {Object} OsmNoteData
@desc An object that store the data found in osm for a svg note creation
@property {string} svg The svg definition created from the OSM map and the itinerary. This will be used as icon for the note
@property {string} tooltip A string with the drection to follow This will be used as tooltip for the note
@property {string} city A string with the city. This will be used for the note address
@property {string} place A place (Can be 'town', 'city', 'village' or 'hamlet') found in OSM.
This will be used for the note address
@property {string} streets A string with all the streets found at the note position. This will be used for the note address
@property {Array.&lt;number>} latLng The latitude and longitude of the nearest itinerary point
@public

@------------------------------------------------------------------------------------------------------------------------------
*/

/**
@------------------------------------------------------------------------------------------------------------------------------

@module SvgIconFromOsmFactory
@private

@------------------------------------------------------------------------------------------------------------------------------
*/

import { theConfig } from '../data/Config.js';
import { theDataSearchEngine } from '../data/DataSearchEngine.js';
import { theGeometry } from '../util/Geometry.js';
import { theSphericalTrigonometry } from '../util/SphericalTrigonometry.js';
import { theTranslator } from '../UI/Translator.js';
import {
	SVG_NS, ICON_DIMENSIONS, LAT_LNG, DISTANCE, ZERO, ONE, TWO, NOT_FOUND, HTTP_STATUS_OK, DEGREES, OSM_COUNTRY_ADMIN_LEVEL
}
	from '../util/Constants.js';

let ourRequestStarted = false;
const OUR_QUERY_DISTANCE = Math.max (
	theConfig.geoCoder.distances.hamlet,
	theConfig.geoCoder.distances.village,
	theConfig.geoCoder.distances.city,
	theConfig.geoCoder.distances.town
);
const OUR_ICON_POSITION = Object.freeze ( {
	atStart : -ONE,
	onRoute : ZERO,
	atEnd : ONE
} );

const OUR_SEARCH_AROUND_FACTOR = 1.5;

/**
@------------------------------------------------------------------------------------------------------------------------------

@function ourNewSvgIconFromOsmFactory
@desc constructor of SvgIconFromOsmFactory object
@return {SvgIconFromOsmFactory} an instance of SvgIconFromOsmFactory object
@private

@------------------------------------------------------------------------------------------------------------------------------
*/

/* eslint-disable-next-line max-statements */
function ourNewSvgIconFromOsmFactory ( ) {

	let myOsmCityAdminLevel = theConfig.geoCoder.osmCityAdminLevel.DEFAULT;
	let mySvgLatLngDistance = Object.seal (
		{
			latLng : [ LAT_LNG.defaultValue, LAT_LNG.defaultValue ],
			distance : DISTANCE.defaultValue
		}
	);
	let myNearestItineraryPoint = null;
	let myRoute = null;
	let myWaysMap = new Map ( );
	let myNodesMap = new Map ( );
	let myAdminNames = [];
	let myPlaces = {};
	let myPlace = null;
	let myCity = null;
	let mySvg = null;
	let myPositionOnRoute = OUR_ICON_POSITION.onRoute;
	let myTranslation = [ ZERO, ZERO ];
	let myRotation = ZERO;
	let myDirection = null;
	let mySvgZoom = theConfig.note.svgIcon.zoom;
	let mySvgAngleDistance = theConfig.note.svgIcon.angleDistance;
	let myDirectionArrow = ' ';
	let myTooltip = '';
	let myStreets = '';
	let myRcnRef = '';

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function mySetHamletAndCity
	@desc this function search the city and hamlet
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function mySetHamletAndCity ( ) {
		myCity = null;
		let adminHamlet = null;

		for ( let namesCounter = TWO; namesCounter &lt; myAdminNames.length; namesCounter ++ ) {
			if ( 'undefined' !== typeof ( myAdminNames [ namesCounter ] ) ) {
				if ( myOsmCityAdminLevel >= namesCounter ) {
					myCity = myAdminNames [ namesCounter ];
				}
				else {
					adminHamlet = myAdminNames [ namesCounter ];
				}
			}
		}
		myPlace = null;
		let placeDistance = Number.MAX_VALUE;

		Object.values ( myPlaces ).forEach (
			place => {
				if ( place.distance &lt; placeDistance ) {
					placeDistance = place.distance;
					myPlace = place.name;
				}
			}
		);

		myPlace = adminHamlet || myPlace;
		if ( myPlace === myCity ) {
			myPlace = null;
		}
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myCreateNodesAndWaysMaps
	@desc This function create the way and node JS maps from the overpassAPI response and extract city and myPlaces
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myCreateNodesAndWaysMaps ( overpassAPIdata ) {
		myWaysMap.clear ( );
		myNodesMap.clear ( );
		myAdminNames = [];
		myPlaces = {
			hamlet : {
				name : null,
				distance : Number.MAX_VALUE,
				maxDistance : theConfig.geoCoder.distances.hamlet
			},
			village : {
				name : null,
				distance : Number.MAX_VALUE,
				maxDistance : theConfig.geoCoder.distances.village
			},
			city : {
				name : null,
				distance : Number.MAX_VALUE,
				maxDistance : theConfig.geoCoder.distances.city
			},
			town : {
				name : null,
				distance : Number.MAX_VALUE,
				maxDistance : theConfig.geoCoder.distances.town
			}
		};
		overpassAPIdata.elements.forEach (
			element => {
				switch ( element.type ) {
				case 'area' :
					{
						let elementName = element.tags.name;
						if (
							theConfig.nominatim.language &amp;&amp;
							'*' !== theConfig.nominatim.language &amp;&amp;
							element.tags [ 'name:' + theConfig.nominatim.language ]
						) {
							elementName = element.tags [ 'name:' + theConfig.nominatim.language ];
						}
						myAdminNames [ Number.parseInt ( element.tags.admin_level ) ] = elementName;
						if ( OSM_COUNTRY_ADMIN_LEVEL === element.tags.admin_level ) {
							myOsmCityAdminLevel =
								theConfig.geoCoder.osmCityAdminLevel [ element.tags [ 'ISO3166-1' ] ] || myOsmCityAdminLevel;
						}
					}
					break;
				case 'way' :
					element.nodesIds = element.nodes;
					delete element.nodes;
					myWaysMap.set ( element.id, element );
					break;
				case 'node' :
					myNodesMap.set ( element.id, element );
					if (
						element.tags &amp;&amp;
						element.tags.place &amp;&amp;
						myPlaces [ element.tags.place ] &amp;&amp;
						element.tags.name
					) {
						let nodeDistance = theSphericalTrigonometry.pointsDistance (
							mySvgLatLngDistance.latLng,
							[ element.lat, element.lon ]
						);
						let place = myPlaces [ element.tags.place ];
						if ( place.maxDistance > nodeDistance &amp;&amp; place.distance > nodeDistance ) {
							place.distance = nodeDistance;
							place.name = element.tags.name;
						}
					}
					break;
				default :
					break;
				}
			}
		);
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function mySearchNearestItineraryPoint
	@desc this function search the nearest itinerary point from the point given by the user
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function mySearchNearestItineraryPoint ( ) {

		// Searching the nearest itinerary point
		let minDistance = Number.MAX_VALUE;
		let distance = DISTANCE.defaultValue;

		// Iteration on the points...
		myRoute.itinerary.itineraryPoints.forEach (
			itineraryPoint => {
				let itineraryPointDistance =
					theSphericalTrigonometry.pointsDistance ( mySvgLatLngDistance.latLng, itineraryPoint.latLng );
				if ( minDistance > itineraryPointDistance ) {
					minDistance = itineraryPointDistance;
					myNearestItineraryPoint = itineraryPoint;
					mySvgLatLngDistance.distance = distance;
				}
				distance += itineraryPoint.distance;
			}
		);

		// The coordinates of the nearest point are used as position of the SVG
		mySvgLatLngDistance.latLng = myNearestItineraryPoint.latLng;

	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myLatLngCompare
	@desc this function compare the lat and lng of the parameter with the lat and lng of the route waypoints
	@param {ItineraryPoint} itineraryPoint the itineraryPoint to test
	@return {boolean} true when the itineraryPoint is not at the same position than a WayPoint and not at the
	same position than the icon point
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myLatLngCompare ( itineraryPoint ) {

		const COMPARE_PRECISION = 0.000005;

		let isWayPoint = false;
		myRoute.wayPoints.forEach (
			wayPoint => {
				if (
					( Math.abs ( itineraryPoint.lat - wayPoint.lat ) &lt; COMPARE_PRECISION )
					&amp;&amp;
					( Math.abs ( itineraryPoint.lng - wayPoint.lng ) &lt; COMPARE_PRECISION )
				) {
					isWayPoint = true;
				}
			}
		);
		return (
			! isWayPoint
			&amp;&amp;
			( myNearestItineraryPoint.lat !== itineraryPoint.lat || myNearestItineraryPoint.lng !== itineraryPoint.lng ) );
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myGetWayName
	@desc return the name of a way
	@param {Object} way  A way found in the request result
	@return the concatenation of the way.tag and way.name if any
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myGetWayName ( way ) {
		return ( way.tags.name ? way.tags.name : '' ) +
			( way.tags.name &amp;&amp; way.tags.ref ? ' ' : '' ) +
			( way.tags.ref ? '[' + way.tags.ref + ']' : '' );
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function mySearchPassingStreets
	@desc this function search all the streets passing trough the nearest itinerary point
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	/* eslint-disable-next-line complexity */
	function mySearchPassingStreets ( ) {

		// searching the previous and next point on the itinerary
		let incomingItineraryPoint =
			myRoute.itinerary.itineraryPoints.previous ( myNearestItineraryPoint.objId, myLatLngCompare );
		let outgoingItineraryPoint =
			myRoute.itinerary.itineraryPoints.next ( myNearestItineraryPoint.objId, myLatLngCompare );

		let svgPointId = NOT_FOUND;
		let incomingNodeId = NOT_FOUND;
		let outgoingNodeId = NOT_FOUND;

		let svgNodeDistance = Number.MAX_VALUE;
		let incomingNodeDistance = Number.MAX_VALUE;
		let outgoingNodeDistance = Number.MAX_VALUE;
		let nodeDistance = DISTANCE.defaultValue;
		let rcnRefNode = null;

		// searching in the nodes JS map the incoming, outgoing and icon nodes
		myNodesMap.forEach (
			node => {
				if ( 'bike' === myRoute.itinerary.transitMode &amp;&amp; node.tags &amp;&amp; node.tags.rcn_ref ) {
					rcnRefNode = node;
				}
				if ( myNearestItineraryPoint ) {
					nodeDistance =
						theSphericalTrigonometry.pointsDistance ( [ node.lat, node.lon ], myNearestItineraryPoint.latLng );
					if ( nodeDistance &lt; svgNodeDistance ) {
						svgPointId = node.id;
						svgNodeDistance = nodeDistance;
					}
				}
				if ( incomingItineraryPoint ) {
					nodeDistance =
						theSphericalTrigonometry.pointsDistance ( [ node.lat, node.lon ], incomingItineraryPoint.latLng );
					if ( nodeDistance &lt; incomingNodeDistance ) {
						incomingNodeId = node.id;
						incomingNodeDistance = nodeDistance;
					}
				}
				if ( outgoingItineraryPoint ) {
					nodeDistance =
						theSphericalTrigonometry.pointsDistance ( [ node.lat, node.lon ], outgoingItineraryPoint.latLng );
					if ( nodeDistance &lt; outgoingNodeDistance ) {
						outgoingNodeId = node.id;
						outgoingNodeDistance = nodeDistance;
					}
				}
			}
		);

		let iconNode = myNodesMap.get ( svgPointId );

		if ( rcnRefNode ) {
			let rcnRefDistance = theSphericalTrigonometry.pointsDistance (
				[ rcnRefNode.lat, rcnRefNode.lon ],
				[ iconNode.lat, iconNode.lon ]
			);
			if ( theConfig.note.svgIcon.rcnRefDistance > rcnRefDistance ) {
				iconNode = rcnRefNode;
			}
		}

		// searching a mini roundabout at the icon node
		let isMiniRoundabout =
			( iconNode &amp;&amp; iconNode.tags &amp;&amp; iconNode.tags.highway &amp;&amp; 'mini_roundabout' === iconNode.tags.highway );

		if (
			'bike' === myRoute.itinerary.transitMode
			&amp;&amp;
			iconNode &amp;&amp; iconNode.tags &amp;&amp; iconNode.tags.rcn_ref
			&amp;&amp;
			iconNode.tags [ 'network:type' ] &amp;&amp; 'node_network' === iconNode.tags [ 'network:type' ]
		) {
			myRcnRef = iconNode.tags.rcn_ref;
			myTooltip += theTranslator.getText ( 'SvgIconFromOsmFactory - rcnRef', { rcnRef : myRcnRef } );
		}

		let incomingStreet = '';
		let outgoingStreet = '';

		let isRoundaboutEntry = false;
		let isRoundaboutExit = false;

		// Searching  passing streets names, incoming and outgoing streets names, roundabout entry and exit
		myWaysMap.forEach (
			way => {
				if ( ! way.nodesIds.includes ( svgPointId ) ) {
					return;
				}

				let wayName = myGetWayName ( way );
				let haveName = '' !== wayName;

				let isIncomingStreet = way.nodesIds.includes ( incomingNodeId );
				let isOutgoingStreet = way.nodesIds.includes ( outgoingNodeId );

				// the same way can enter multiple times in the intersection!
				let streetOcurrences = way.nodesIds.filter ( nodeId => nodeId === svgPointId ).length * TWO;

				// the icon is at the begining of the street
				if ( way.nodesIds [ ZERO ] === svgPointId ) {
					streetOcurrences --;
				}

				// the icon is at end of the street
				if ( way.nodesIds [ way.nodesIds.length - ONE ] === svgPointId ) {
					streetOcurrences --;
				}

				// it's the incoming street ...saving name  and eventually the roundabout exit
				if ( isIncomingStreet ) {
					incomingStreet = haveName ? wayName : '???';
					streetOcurrences --;
					if ( way.tags.junction &amp;&amp; 'roundabout' === way.tags.junction ) {
						isRoundaboutExit = true;
					}
				}
				if ( ZERO === streetOcurrences ) {
					return;
				}

				// it's the outgoing street ...saving name  and eventually the roundabout exit
				if ( isOutgoingStreet ) {
					outgoingStreet = haveName ? wayName : '???';
					streetOcurrences --;
					if ( way.tags.junction &amp;&amp; 'roundabout' === way.tags.junction ) {
						isRoundaboutEntry = true;
					}
				}
				if ( ZERO === streetOcurrences || ! haveName ) {
					return;
				}

				// It's a passing street ... saving name...
				while ( ZERO !== streetOcurrences ) {
					myStreets = '' === myStreets ? wayName : myStreets + ' ⪥  ' + wayName; // ⪥  = >&lt;
					streetOcurrences --;
				}
			}
		);

		if ( OUR_ICON_POSITION.atStart === myPositionOnRoute ) {

			// It's the start point adding a green circle to the outgoing street
			myStreets = '🟢 ' + outgoingStreet;
		}
		else if ( OUR_ICON_POSITION.atEnd === myPositionOnRoute ) {

			// It's the end point adding a red circle to the incoming street
			myStreets = incomingStreet + ' 🔴 ';
		}
		else {

			// Adiing the incoming and outgoing streets and direction arrow
			myStreets =
				incomingStreet +
				( '' === myStreets ? '' : ' ⪥  ' + myStreets ) + // ⪥ = >&lt;
				' ' + myDirectionArrow + ' ' +
				outgoingStreet;
		}

		// adding roundabout info
		if ( isRoundaboutEntry &amp;&amp; ! isRoundaboutExit ) {
			myTooltip += theTranslator.getText ( 'SvgIconFromOsmFactory - entry roundabout' );
		}
		else if ( ! isRoundaboutEntry &amp;&amp; isRoundaboutExit ) {
			myTooltip += theTranslator.getText ( 'SvgIconFromOsmFactory - exit roundabout' );
		}
		else if ( isRoundaboutEntry &amp;&amp; isRoundaboutExit ) {
			myTooltip += theTranslator.getText ( 'SvgIconFromOsmFactory - continue roundabout' ); // strange but correct
		}
		if ( isMiniRoundabout ) {
			myTooltip += theTranslator.getText ( 'SvgIconFromOsmFactory - at the small roundabout on the ground' );
		}
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myComputeTranslation
	@desc this function compute the translation needed to have the itinerary point in the middle of the svg
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myComputeTranslation ( ) {
		myTranslation = theGeometry.subtrackPoints (
			[ ICON_DIMENSIONS.svgViewboxDim / TWO, ICON_DIMENSIONS.svgViewboxDim / TWO ],
			theGeometry.project ( mySvgLatLngDistance.latLng, mySvgZoom )
		);
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myComputeRotationAndDirection
	@desc This function compute the rotation needed to have the SVG oriented on the itinerary
	and compute also the direction to take after the icon
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myComputeRotationAndDirection ( ) {

		// searching points at least at 10 m ( mySvgAngleDistance ) from the icon point,
		// one for rotation and one for direction
		let distance = DISTANCE.defaultValue;
		let rotationItineraryPoint = myRoute.itinerary.itineraryPoints.first;
		let directionItineraryPoint = myRoute.itinerary.itineraryPoints.last;
		let directionPointReached = false;

		myRoute.itinerary.itineraryPoints.forEach (
			itineraryPoint => {
				if ( mySvgLatLngDistance.distance - distance > mySvgAngleDistance ) {
					rotationItineraryPoint = itineraryPoint;
				}
				if ( distance - mySvgLatLngDistance.distance > mySvgAngleDistance &amp;&amp; ! directionPointReached ) {
					directionItineraryPoint = itineraryPoint;
					directionPointReached = true;
				}
				distance += itineraryPoint.distance;
			}
		);

		let iconPoint = theGeometry.addPoints (
			theGeometry.project ( mySvgLatLngDistance.latLng, mySvgZoom ),
			myTranslation
		);

		// computing rotation... if possible
		if ( myNearestItineraryPoint.objId !== myRoute.itinerary.itineraryPoints.first.objId ) {
			let rotationPoint = theGeometry.addPoints (
				theGeometry.project ( rotationItineraryPoint.latLng, mySvgZoom ),
				myTranslation
			);
			myRotation =
				Math.atan (
					( iconPoint [ ONE ] - rotationPoint [ ONE ] )
					/
					( rotationPoint [ ZERO ] - iconPoint [ ZERO ] )
				)
				*
				DEGREES.d180 / Math.PI;
			if ( ZERO > myRotation ) {
				myRotation += DEGREES.d360;
			}
			myRotation -= DEGREES.d270;

			// point 0,0 of the svg is the UPPER left corner
			if ( ZERO > rotationPoint [ ZERO ] - iconPoint [ ZERO ] ) {
				myRotation += DEGREES.d180;
			}
		}

		// computing direction ... if possible

		if ( myNearestItineraryPoint.objId !== myRoute.itinerary.itineraryPoints.last.objId ) {
			let directionPoint = theGeometry.addPoints (
				theGeometry.project ( directionItineraryPoint.latLng, mySvgZoom ),
				myTranslation
			);
			myDirection = Math.atan (
				( iconPoint [ ONE ] - directionPoint [ ONE ] )
				/
				( directionPoint [ ZERO ] - iconPoint [ ZERO ] )
			)
				*
				DEGREES.d180 / Math.PI;

			// point 0,0 of the svg is the UPPER left corner
			if ( ZERO > directionPoint [ ZERO ] - iconPoint [ ZERO ] ) {
				myDirection += DEGREES.d180;
			}
			myDirection -= myRotation;

			// setting direction between 0 and 360
			while ( DEGREES.d0 > myDirection ) {
				myDirection += DEGREES.d360;
			}
			while ( DEGREES.d360 &lt; myDirection ) {
				myDirection -= DEGREES.d360;
			}
		}
		if ( myNearestItineraryPoint.objId === myRoute.itinerary.itineraryPoints.first.objId ) {
			myRotation = -myDirection - DEGREES.d90;
			myDirection = null;
			myPositionOnRoute = OUR_ICON_POSITION.atStart;
		}

		if (
			mySvgLatLngDistance.latLng [ ZERO ] === myRoute.itinerary.itineraryPoints.last.lat
			&amp;&amp;
			mySvgLatLngDistance.latLng [ ONE ] === myRoute.itinerary.itineraryPoints.last.lng
		) {

			// using lat &amp; lng because last point is sometime duplicated
			myDirection = null;
			myPositionOnRoute = OUR_ICON_POSITION.atEnd;
		}
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function mySetDirectionArrowAndTooltip
	@desc this function set the direction arrow and tooltip
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function mySetDirectionArrowAndTooltip ( ) {

		if ( null !== myDirection ) {
			if ( myDirection &lt; theConfig.note.svgIcon.angleDirection.right ) {
				myTooltip = theTranslator.getText ( 'SvgIconFromOsmFactory - Turn right' );
				myDirectionArrow = '🢂';
			}
			else if ( myDirection &lt; theConfig.note.svgIcon.angleDirection.slightRight ) {
				myTooltip = theTranslator.getText ( 'SvgIconFromOsmFactory - Turn slight right' );
				myDirectionArrow = '🢅';
			}
			else if ( myDirection &lt; theConfig.note.svgIcon.angleDirection.continue ) {
				myTooltip = theTranslator.getText ( 'SvgIconFromOsmFactory - Continue' );
				myDirectionArrow = '🢁';
			}
			else if ( myDirection &lt; theConfig.note.svgIcon.angleDirection.slightLeft ) {
				myTooltip = theTranslator.getText ( 'SvgIconFromOsmFactory - Turn slight left' );
				myDirectionArrow = '🢄';
			}
			else if ( myDirection &lt; theConfig.note.svgIcon.angleDirection.left ) {
				myTooltip = theTranslator.getText ( 'SvgIconFromOsmFactory - Turn left' );
				myDirectionArrow = '🢀';
			}
			else if ( myDirection &lt; theConfig.note.svgIcon.angleDirection.sharpLeft ) {
				myTooltip = theTranslator.getText ( 'SvgIconFromOsmFactory - Turn sharp left' );
				myDirectionArrow = '🢇';
			}
			else if ( myDirection &lt; theConfig.note.svgIcon.angleDirection.sharpRight ) {
				myTooltip = theTranslator.getText ( 'SvgIconFromOsmFactory - Turn sharp right' );
				myDirectionArrow = '🢆';
			}
			else {
				myTooltip = theTranslator.getText ( 'SvgIconFromOsmFactory - Turn right' );
				myDirectionArrow = '🢂';
			}
		}

		if ( OUR_ICON_POSITION.atStart === myPositionOnRoute ) {
			myTooltip = theTranslator.getText ( 'SvgIconFromOsmFactory - Start' );
		}
		else if ( OUR_ICON_POSITION.atEnd === myPositionOnRoute ) {
			myTooltip = theTranslator.getText ( 'SvgIconFromOsmFactory - Stop' );
		}
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myCreateRoute
	@desc This function create the SVG polyline for the route
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myCreateRoute ( ) {

		// to avoid a big svg, all points outside the svg viewBox are not added
		let index = -ONE;
		let firstPointIndex = NOT_FOUND;
		let lastPointIndex = NOT_FOUND;
		let points = [];
		myRoute.itinerary.itineraryPoints.forEach (
			itineraryPoint => {
				index ++;
				let point = theGeometry.addPoints ( theGeometry.project ( itineraryPoint.latLng, mySvgZoom ), myTranslation );
				points.push ( point );
				let pointIsInside =
					point [ ZERO ] >= ZERO &amp;&amp; point [ ONE ] >= ZERO
					&amp;&amp;
					point [ ZERO ] &lt;= ICON_DIMENSIONS.svgViewboxDim
					&amp;&amp;
					point [ ONE ] &lt;= ICON_DIMENSIONS.svgViewboxDim;
				if ( pointIsInside ) {
					if ( NOT_FOUND === firstPointIndex ) {
						firstPointIndex = index;
					}
					lastPointIndex = index;
				}
			}
		);
		if ( NOT_FOUND !== firstPointIndex &amp;&amp; NOT_FOUND !== lastPointIndex ) {
			if ( ZERO &lt; firstPointIndex ) {
				firstPointIndex --;
			}
			if ( myRoute.itinerary.itineraryPoints.length - ONE > lastPointIndex ) {
				lastPointIndex ++;
			}
			let pointsAttribute = '';
			for ( index = firstPointIndex; index &lt;= lastPointIndex; index ++ ) {
				pointsAttribute += points[ index ] [ ZERO ].toFixed ( ZERO ) + ',' +
					points[ index ] [ ONE ].toFixed ( ZERO ) + ' ';
			}
			let polyline = document.createElementNS ( SVG_NS, 'polyline' );
			polyline.setAttributeNS ( null, 'points', pointsAttribute );
			polyline.setAttributeNS ( null, 'class', 'TravelNotes-OSM-Itinerary' );
			polyline.setAttributeNS (
				null,
				'transform',
				'rotate(' + myRotation +
					',' + ( ICON_DIMENSIONS.svgViewboxDim / TWO ) +
					',' + ( ICON_DIMENSIONS.svgViewboxDim / TWO )
					+ ')'
			);
			mySvg.appendChild ( polyline );
		}

	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myCreateWays
	@desc This function creates the ways from OSM
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myCreateWays ( ) {

		// to avoid a big svg, all points outside the svg viewBox are not added
		myWaysMap.forEach (
			way => {
				let firstPointIndex = NOT_FOUND;
				let lastPointIndex = NOT_FOUND;
				let index = -ONE;
				let points = [ ];
				way.nodesIds.forEach (
					nodeId => {
						index ++;
						let node = myNodesMap.get ( nodeId );
						let point = theGeometry.addPoints (
							theGeometry.project ( [ node.lat, node.lon ], mySvgZoom ),
							myTranslation
						);
						points.push ( point );
						let pointIsInside =
							point [ ZERO ] >= ZERO
							&amp;&amp;
							point [ ONE ] >= ZERO
							&amp;&amp;
							point [ ZERO ] &lt;= ICON_DIMENSIONS.svgViewboxDim
							&amp;&amp;
							point [ ONE ] &lt;= ICON_DIMENSIONS.svgViewboxDim;
						if ( pointIsInside ) {
							if ( NOT_FOUND === firstPointIndex ) {
								firstPointIndex = index;
							}
							lastPointIndex = index;
						}
					}
				);
				if ( NOT_FOUND !== firstPointIndex &amp;&amp; NOT_FOUND !== lastPointIndex ) {
					if ( ZERO &lt; firstPointIndex ) {
						firstPointIndex --;
					}
					if ( way.nodesIds.length - ONE > lastPointIndex ) {
						lastPointIndex ++;
					}
					let pointsAttribute = '';
					for ( index = firstPointIndex; index &lt;= lastPointIndex; index ++ ) {
						pointsAttribute +=
							points[ index ] [ ZERO ].toFixed ( ZERO ) + ',' +
							points[ index ] [ ONE ].toFixed ( ZERO ) + ' ';
					}

					let polyline = document.createElementNS ( SVG_NS, 'polyline' );
					polyline.setAttributeNS ( null, 'points', pointsAttribute );
					polyline.setAttributeNS (
						null,
						'class',
						'TravelNotes-OSM-Highway TravelNotes-OSM-Highway-' + way.tags.highway
					);
					polyline.setAttributeNS (
						null,
						'transform',
						'rotate(' + myRotation +
							',' + ( ICON_DIMENSIONS.svgViewboxDim / TWO ) +
							',' + ( ICON_DIMENSIONS.svgViewboxDim / TWO ) +
							')'
					);

					mySvg.appendChild ( polyline );
				}
			}
		);
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myCreateRcnRef
	@desc This function creates the RcnRef from OSM
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myCreateRcnRef ( ) {
		const Y_TEXT = 0.6;
		if ( '' === myRcnRef ) {
			return;
		}
		let svgText = document.createElementNS ( SVG_NS, 'text' );
		svgText.textContent = myRcnRef;
		svgText.setAttributeNS ( null, 'x', String ( ICON_DIMENSIONS.svgViewboxDim / TWO ) );
		svgText.setAttributeNS ( null, 'y', String ( ICON_DIMENSIONS.svgViewboxDim * Y_TEXT ) );
		svgText.setAttributeNS ( null, 'class', 'TravelNotes-OSM-RcnRef' );
		mySvg.appendChild ( svgText );
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myCreateSvg
	@desc This function creates the SVG
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myCreateSvg ( ) {
		const FOUR = 4;
		mySvg = document.createElementNS ( SVG_NS, 'svg' );
		mySvg.setAttributeNS (
			null,
			'viewBox',
			String ( ICON_DIMENSIONS.svgViewboxDim / FOUR ) + ' ' +
			( ICON_DIMENSIONS.svgViewboxDim / FOUR ) + ' ' +
			( ICON_DIMENSIONS.svgViewboxDim / TWO ) + ' ' +
			( ICON_DIMENSIONS.svgViewboxDim / TWO )
		);
		mySvg.setAttributeNS ( null, 'class', 'TravelNotes-SvgIcon' );
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myGetUrl
	@desc this function creates the full url needed to have the data fromm osm
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myGetUrl ( ) {

		/*
		Sample of request:

		https://lz4.overpass-api.de/api/interpreter?
		data=
			[out:json][timeout:40];
			way[highway](around:300,50.489312,5.501035)->.a;(.a >;.a;)->.a;.a out;
			is_in(50.644242,5.572354)->.e;area.e[admin_level][boundary="administrative"];out;
			node(around:1500,50.644242,5.572354)[place];out;
		*/

		let requestLatLng =
			mySvgLatLngDistance.latLng [ ZERO ].toFixed ( LAT_LNG.fixed ) +
			',' +
			mySvgLatLngDistance.latLng [ ONE ].toFixed ( LAT_LNG.fixed );

		let requestUrl = theConfig.overpassApi.url +
			'?data=[out:json][timeout:' + theConfig.overpassApi.timeOut + '];' +
			'way[highway](around:' +
			( ICON_DIMENSIONS.svgViewboxDim * OUR_SEARCH_AROUND_FACTOR ).toFixed ( ZERO ) +
			',' + requestLatLng + ')->.a;(.a >;.a;)->.a;.a out;' +
			'is_in(' + requestLatLng + ')->.e;area.e[admin_level][boundary="administrative"];out;' +
			'node(around:' + OUR_QUERY_DISTANCE + ',' + requestLatLng + ')[place];out;';

		return requestUrl;
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myBuildIconAndAdress
	@desc Search and build all the needed data
	@param {function} onOk The success handler passed to the Promise
	@param {function} onError The error handler passed to the Promise
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myBuildIconAndAdress ( overpassAPIdata, onOk /* , onError */ ) {
		myCreateNodesAndWaysMaps ( overpassAPIdata );
		myCreateSvg ( );
		mySetHamletAndCity ( );
		myComputeTranslation ( );
		myComputeRotationAndDirection ( );
		mySetDirectionArrowAndTooltip ( );
		mySearchPassingStreets ( );
		myCreateRoute ( );
		myCreateWays ( );
		myCreateRcnRef ( );

		ourRequestStarted = false;

		onOk (
			Object.freeze (
				{
					svg : mySvg,
					tooltip : myTooltip,
					city : myCity,
					place : myPlace,
					streets : myStreets,
					latLng : myNearestItineraryPoint.latLng
				}
			)
		);
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function myGetIconAndAdress
	@desc This is the entry point for the icon creation
	@param {function} onOk The success handler passed to the Promise
	@param {function} onError The error handler passed to the Promise
	@private

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	function myGetIconAndAdress ( onOk, onError ) {

		if ( ourRequestStarted ) {
			onError ( 'A request is already running' );
			return;
		}

		ourRequestStarted = true;

		mySvg = null;
		myCity = null;
		myPlace = null;
		myDirectionArrow = ' ';
		myTooltip = '';
		myStreets = '';

		mySearchNearestItineraryPoint ( );

		fetch ( myGetUrl ( ) )
			.then (
				response => {
					if ( HTTP_STATUS_OK === response.status &amp;&amp; response.ok ) {
						response.json ( )
							. then ( overpassAPIdata => myBuildIconAndAdress ( overpassAPIdata, onOk, onError ) )
							.catch (
								err => {
									ourRequestStarted = false;
									onError ( err );
								}
							);
					}
					else {
						ourRequestStarted = false;
						onError ( new Error ( 'An error occurs when callin OverpassAPI' ) );
					}
				}
			);
	}

	/**
	@--------------------------------------------------------------------------------------------------------------------------

	@class
	@classdesc This class is used to create  an svg icon for a route note
	@see {@link newSvgIconFromOsmFactory} for constructor
	@hideconstructor

	@--------------------------------------------------------------------------------------------------------------------------
	*/

	class SvgIconFromOsmFactory {

		constructor ( ) {
			Object.freeze ( this );
		}

		/**
		this function returns a Promise for the svg icon creation
		@param {array.&lt;number>} iconLatLng The lat and lng where the icon must be createDocumentFragment
		@param {!number} routeObjId the objId of the route
		@return {Promise} A promise that fulfill with a OsmNoteData object completed
		*/

		getPromiseIconAndAdress ( iconLatLng, routeObjId ) {
			mySvgLatLngDistance.latLng = iconLatLng;
			myRoute = theDataSearchEngine.getRoute ( routeObjId );

			return new Promise ( myGetIconAndAdress );
		}
	}

	return new SvgIconFromOsmFactory ( );
}

/**
	@--------------------------------------------------------------------------------------------------------------------------

	@function newSvgIconFromOsmFactory
	@desc constructor of SvgIconFromOsmFactory object
	@return {SvgIconFromOsmFactory} an instance of SvgIconFromOsmFactory object
	@global

	@--------------------------------------------------------------------------------------------------------------------------
	*/

export {
	ourNewSvgIconFromOsmFactory as newSvgIconFromOsmFactory
};

/*
--- End of svgIconFromOsmFactory.js file --------------------------------------------------------------------------------------
*/</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-AboutDialog-AboutDialog.html">AboutDialog</a></li><li><a href="module-APIKeysDialog-APIKeysDialog.html">APIKeysDialog</a></li><li><a href="module-APIKeysManager-APIKeysManager.html">APIKeysManager</a></li><li><a href="module-AttributionsUI-AttributionsUI.html">AttributionsUI</a></li><li><a href="module-BaseContextMenu-BaseContextMenu.html">BaseContextMenu</a></li><li><a href="module-BaseDialog-BaseDialog.html">BaseDialog</a></li><li><a href="module-Collection-Collection.html">Collection</a></li><li><a href="module-ColorDialog-Color.html">Color</a></li><li><a href="module-ColorDialog-ColorDialog.html">ColorDialog</a></li><li><a href="module-Config-Config.html">Config</a></li><li><a href="module-DataEncryptor-DataEncryptor.html">DataEncryptor</a></li><li><a href="module-DataSearchEngine-DataSearchEngine.html">DataSearchEngine</a></li><li><a href="module-ErrorsUI-ErrorsUI.html">ErrorsUI</a></li><li><a href="module-EventDispatcher-EventDispatcher.html">EventDispatcher</a></li><li><a href="module-FileCompactor-FileCompactor.html">FileCompactor</a></li><li><a href="module-FileLoader-FileLoader.html">FileLoader</a></li><li><a href="module-FloatWindow-FloatWindow.html">FloatWindow</a></li><li><a href="module-GeoCoder-GeoCoder.html">GeoCoder</a></li><li><a href="module-GeoLocator-GeoLocator.html">GeoLocator</a></li><li><a href="module-Geometry-Geometry.html">Geometry</a></li><li><a href="module-GpxFactory-GpxFactory.html">GpxFactory</a></li><li><a href="module-GraphHopperRouteProvider-GraphHopperRouteProvider.html">GraphHopperRouteProvider</a></li><li><a href="module-HTMLElementsFactory-HTMLElementsFactory.html">HTMLElementsFactory</a></li><li><a href="module-HTMLSanitizer-HTMLSanitizer.html">HTMLSanitizer</a></li><li><a href="module-HTMLSanitizer-ourValidityMap.html">ourValidityMap</a></li><li><a href="module-HTMLViewsFactory-HTMLViewsFactory.html">HTMLViewsFactory</a></li><li><a href="module-IndexedDb-IndexedDb.html">IndexedDb</a></li><li><a href="module-ItineraryPaneUI-ItineraryPaneUI.html">ItineraryPaneUI</a></li><li><a href="module-ItineraryPoint-ItineraryPoint.html">ItineraryPoint</a></li><li><a href="module-Itinerary-Itinerary.html">Itinerary</a></li><li><a href="module-LayersToolbarUI-LayersToolbarUI.html">LayersToolbarUI</a></li><li><a href="module-Layer-Layer.html">Layer</a></li><li><a href="module-ManeuverContextMenu-ManeuverContextMenu.html">ManeuverContextMenu</a></li><li><a href="module-Maneuver-Maneuver.html">Maneuver</a></li><li><a href="module-MapboxRouteProvider-MapboxRouteProvider.html">MapboxRouteProvider</a></li><li><a href="module-MapContextMenu-MapContextMenu.html">MapContextMenu</a></li><li><a href="module-MapEditor-MapEditor.html">MapEditor</a></li><li><a href="module-MapzenValhallaRouteProvider-MapzenValhallaRouteProvider.html">MapzenValhallaRouteProvider</a></li><li><a href="module-MouseUI-MouseUI.html">MouseUI</a></li><li><a href="module-NoteContextMenu-NoteContextMenu.html">NoteContextMenu</a></li><li><a href="module-NoteDialogToolbar-NoteDialogToolbar.html">NoteDialogToolbar</a></li><li><a href="module-NoteDialog-NoteDialog.html">NoteDialog</a></li><li><a href="module-NoteEditor-NoteEditor.html">NoteEditor</a></li><li><a href="module-Note-Note.html">Note</a></li><li><a href="module-ObjType-ObjType.html">ObjType</a></li><li><a href="module-OpenRouteServiceRouteProvider-OpenRouteServiceRouteProvider.html">OpenRouteServiceRouteProvider</a></li><li><a href="module-OsmSearchContextMenu-OsmSearchContextMenu.html">OsmSearchContextMenu</a></li><li><a href="module-OsmSearchEngine-DictionaryItem.html">DictionaryItem</a></li><li><a href="module-OsmSearchEngine-OsmSearchEngine.html">OsmSearchEngine</a></li><li><a href="module-OsmSearchPaneUI-OsmSearchPaneUI.html">OsmSearchPaneUI</a></li><li><a href="module-OsrmRouteProvider-OsrmRouteProvider.html">OsrmRouteProvider</a></li><li><a href="module-OsrmTextInstructions-OsrmTextInstructions.html">OsrmTextInstructions</a></li><li><a href="module-PanesManagerUI-PanesManagerUI.html">PanesManagerUI</a></li><li><a href="module-PasswordDialog-PasswordDialog.html">PasswordDialog</a></li><li><a href="module-PolylineRouteProvider-PolylineRouteProvider.html">PolylineRouteProvider</a></li><li><a href="module-PrintFactory-PrintFactory.html">PrintFactory</a></li><li><a href="module-PrintRouteMapDialog-PrintRouteMapDialog.html">PrintRouteMapDialog</a></li><li><a href="module-ProfileContextMenu-ProfileContextMenu.html">ProfileContextMenu</a></li><li><a href="module-ProfileFactory-ProfileFactory.html">ProfileFactory</a></li><li><a href="module-ProfileWindowsManager-ProfileWindowsManager.html">ProfileWindowsManager</a></li><li><a href="module-ProfileWindow-ProfileWindow.html">ProfileWindow</a></li><li><a href="module-ProvidersToolbarUI-ProvidersToolbarUI.html">ProvidersToolbarUI</a></li><li><a href="module-PublicTransportRouteProvider-PublicTransportRouteProvider.html">PublicTransportRouteProvider</a></li><li><a href="module-RouteContextMenu-RouteContextMenu.html">RouteContextMenu</a></li><li><a href="module-RouteEditor-RouteEditor.html">RouteEditor</a></li><li><a href="module-RoutePropertiesDialog-RoutePropertiesDialog.html">RoutePropertiesDialog</a></li><li><a href="module-Route-Route.html">Route</a></li><li><a href="module-SaveAsDialog-SaveAsDialog.html">SaveAsDialog</a></li><li><a href="module-SphericalTrigonometry-SphericalTrigonometry.html">SphericalTrigonometry</a></li><li><a href="module-SvgIconFromOsmFactory-SvgIconFromOsmFactory.html">SvgIconFromOsmFactory</a></li><li><a href="module-Translator-Translator.html">Translator</a></li><li><a href="module-TravelEditor-TravelEditor.html">TravelEditor</a></li><li><a href="module-TravelNotesData-TravelNotesData.html">TravelNotesData</a></li><li><a href="module-TravelNotesPaneUI-TravelNotesPaneUI.html">TravelNotesPaneUI</a></li><li><a href="module-TravelNotesToolbarUI-TravelNotesToolbarUI.html">TravelNotesToolbarUI</a></li><li><a href="module-TravelNotesViewer-TravelNotesViewer.html">TravelNotesViewer</a></li><li><a href="module-TravelNotes-TravelNotes.html">TravelNotes</a></li><li><a href="module-TravelUI-TravelUI.html">TravelUI</a></li><li><a href="module-Travel-Travel.html">Travel</a></li><li><a href="module-TwoButtonsDialog-TwoButtonsDialog.html">TwoButtonsDialog</a></li><li><a href="module-UI-UI.html">UI</a></li><li><a href="module-Utilities-Utilities.html">Utilities</a></li><li><a href="module-ViewerFileLoader-ViewerFileLoader.html">ViewerFileLoader</a></li><li><a href="module-ViewerLayersToolbarUI-ViewerLayersToolbarUI.html">ViewerLayersToolbarUI</a></li><li><a href="module-ViewerMapEditor-ViewerMapEditor.html">ViewerMapEditor</a></li><li><a href="module-WaitUI-WaitUI.html">WaitUI</a></li><li><a href="module-WayPointContextMenu-WayPointContextMenu.html">WayPointContextMenu</a></li><li><a href="module-WayPointEditor-WayPointEditor.html">WayPointEditor</a></li><li><a href="module-WayPointPropertiesDialog-WayPointPropertiesDialog.html">WayPointPropertiesDialog</a></li><li><a href="module-WayPoint-WayPoint.html">WayPoint</a></li><li><a href="module-Zoomer-Zoomer.html">Zoomer</a></li></ul><h3>Interfaces</h3><ul><li><a href="PaneUI.html">PaneUI</a></li><li><a href="Provider.html">Provider</a></li></ul><h3>Events</h3><ul><li><a href="module-EventDispatcher.html#~event:additinerarypointmarker">additinerarypointmarker</a></li><li><a href="module-EventDispatcher.html#~event:addrectangle">addrectangle</a></li><li><a href="module-EventDispatcher.html#~event:addsearchpointmarker">addsearchpointmarker</a></li><li><a href="module-EventDispatcher.html#~event:addwaypoint">addwaypoint</a></li><li><a href="module-EventDispatcher.html#~event:geolocationpositionchanged">geolocationpositionchanged</a></li><li><a href="module-EventDispatcher.html#~event:geolocationstatuschanged">geolocationstatuschanged</a></li><li><a href="module-EventDispatcher.html#~event:layerchange">layerchange</a></li><li><a href="module-EventDispatcher.html#~event:noteupdated">noteupdated</a></li><li><a href="module-EventDispatcher.html#~event:profileclosed">profileclosed</a></li><li><a href="module-EventDispatcher.html#~event:providersadded">providersadded</a></li><li><a href="module-EventDispatcher.html#~event:removeallobjects">removeallobjects</a></li><li><a href="module-EventDispatcher.html#~event:removeobject">removeobject</a></li><li><a href="module-EventDispatcher.html#~event:roadbookupdate">roadbookupdate</a></li><li><a href="module-EventDispatcher.html#~event:routepropertiesupdated">routepropertiesupdated</a></li><li><a href="module-EventDispatcher.html#~event:routeupdated">routeupdated</a></li><li><a href="module-EventDispatcher.html#~event:setprovider">setprovider</a></li><li><a href="module-EventDispatcher.html#~event:setrouteslist">setrouteslist</a></li><li><a href="module-EventDispatcher.html#~event:settransitmode">settransitmode</a></li><li><a href="module-EventDispatcher.html#~event:showitinerary">showitinerary</a></li><li><a href="module-EventDispatcher.html#~event:showsearch">showsearch</a></li><li><a href="module-EventDispatcher.html#~event:showtravelnotes">showtravelnotes</a></li><li><a href="module-EventDispatcher.html#~event:travelnameupdated">travelnameupdated</a></li><li><a href="module-EventDispatcher.html#~event:updateitinerary">updateitinerary</a></li><li><a href="module-EventDispatcher.html#~event:updatesearch">updatesearch</a></li><li><a href="module-EventDispatcher.html#~event:updatetravelnotes">updatetravelnotes</a></li><li><a href="module-EventDispatcher.html#~event:zoomto">zoomto</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-InstallationGuideEN.html">InstallationGuideEN</a></li><li><a href="tutorial-UserGuideEN.html">UserGuideEN</a></li><li><a href="tutorial-WhatsNew.html">WhatsNew</a></li><li><a href="tutorial-GuideInstallationFR.html">GuideInstallationFR</a></li><li><a href="tutorial-GuideUtilisateurFR.html">GuideUtilisateurFR</a></li><li><a href="tutorial-QuoiDeNeuf.html">QuoiDeNeuf</a></li><li><a href="tutorial-README.html">README</a></li></ul><h3>Global</h3><ul><li><a href="global.html#newAboutDialog">newAboutDialog</a></li><li><a href="global.html#newAPIKeysDialog">newAPIKeysDialog</a></li><li><a href="global.html#newBaseContextMenu">newBaseContextMenu</a></li><li><a href="global.html#newBaseDialog">newBaseDialog</a></li><li><a href="global.html#newCollection">newCollection</a></li><li><a href="global.html#newColorDialog">newColorDialog</a></li><li><a href="global.html#newDataEncryptor">newDataEncryptor</a></li><li><a href="global.html#newFileCompactor">newFileCompactor</a></li><li><a href="global.html#newFileLoader">newFileLoader</a></li><li><a href="global.html#newFloatWindow">newFloatWindow</a></li><li><a href="global.html#newGeoCoder">newGeoCoder</a></li><li><a href="global.html#newGpxFactory">newGpxFactory</a></li><li><a href="global.html#newItinerary">newItinerary</a></li><li><a href="global.html#newItineraryPoint">newItineraryPoint</a></li><li><a href="global.html#newLayer">newLayer</a></li><li><a href="global.html#newManeuver">newManeuver</a></li><li><a href="global.html#newManeuverContextMenu">newManeuverContextMenu</a></li><li><a href="global.html#newMapContextMenu">newMapContextMenu</a></li><li><a href="global.html#newNote">newNote</a></li><li><a href="global.html#newNoteContextMenu">newNoteContextMenu</a></li><li><a href="global.html#newNoteDialog">newNoteDialog</a></li><li><a href="global.html#newObjId">newObjId</a></li><li><a href="global.html#newObjType">newObjType</a></li><li><a href="global.html#newOsmSearchContextMenu">newOsmSearchContextMenu</a></li><li><a href="global.html#newPasswordDialog">newPasswordDialog</a></li><li><a href="global.html#newPrintFactory">newPrintFactory</a></li><li><a href="global.html#newPrintRouteMapDialog">newPrintRouteMapDialog</a></li><li><a href="global.html#newProfileContextMenu">newProfileContextMenu</a></li><li><a href="global.html#newProfileFactory">newProfileFactory</a></li><li><a href="global.html#newProfileWindow">newProfileWindow</a></li><li><a href="global.html#newRoadbookUpdate">newRoadbookUpdate</a></li><li><a href="global.html#newRoute">newRoute</a></li><li><a href="global.html#newRouteContextMenu">newRouteContextMenu</a></li><li><a href="global.html#newRoutePropertiesDialog">newRoutePropertiesDialog</a></li><li><a href="global.html#newSaveAsDialog">newSaveAsDialog</a></li><li><a href="global.html#newSvgIconFromOsmFactory">newSvgIconFromOsmFactory</a></li><li><a href="global.html#newTravel">newTravel</a></li><li><a href="global.html#newTravelNotesPaneUI">newTravelNotesPaneUI</a></li><li><a href="global.html#newTwoButtonsDialog">newTwoButtonsDialog</a></li><li><a href="global.html#newViewerFileLoader">newViewerFileLoader</a></li><li><a href="global.html#newWaitUI">newWaitUI</a></li><li><a href="global.html#newWayPoint">newWayPoint</a></li><li><a href="global.html#newWayPointContextMenu">newWayPointContextMenu</a></li><li><a href="global.html#newWayPointPropertiesDialog">newWayPointPropertiesDialog</a></li><li><a href="global.html#newZoomer">newZoomer</a></li><li><a href="global.html#theAPIKeysManager">theAPIKeysManager</a></li><li><a href="global.html#theAttributionsUI">theAttributionsUI</a></li><li><a href="global.html#theConfig">theConfig</a></li><li><a href="global.html#theCurrentVersion">theCurrentVersion</a></li><li><a href="global.html#theDataSearchEngine">theDataSearchEngine</a></li><li><a href="global.html#theErrorsUI">theErrorsUI</a></li><li><a href="global.html#theEventDispatcher">theEventDispatcher</a></li><li><a href="global.html#theGeoLocator">theGeoLocator</a></li><li><a href="global.html#theGeometry">theGeometry</a></li><li><a href="global.html#theHTMLElementsFactory">theHTMLElementsFactory</a></li><li><a href="global.html#theHTMLSanitizer">theHTMLSanitizer</a></li><li><a href="global.html#theHTMLViewsFactory">theHTMLViewsFactory</a></li><li><a href="global.html#theIndexedDb">theIndexedDb</a></li><li><a href="global.html#theLayersToolbarUI">theLayersToolbarUI</a></li><li><a href="global.html#theMapEditor">theMapEditor</a></li><li><a href="global.html#theMouseUI">theMouseUI</a></li><li><a href="global.html#theNoteDialogToolbar">theNoteDialogToolbar</a></li><li><a href="global.html#theNoteEditor">theNoteEditor</a></li><li><a href="global.html#theOsmSearchEngine">theOsmSearchEngine</a></li><li><a href="global.html#theOsrmTextInstructions">theOsrmTextInstructions</a></li><li><a href="global.html#thePanesManagerUI">thePanesManagerUI</a></li><li><a href="global.html#thePolylineEncoder">thePolylineEncoder</a></li><li><a href="global.html#theProfileWindowsManager">theProfileWindowsManager</a></li><li><a href="global.html#theProvidersToolbarUI">theProvidersToolbarUI</a></li><li><a href="global.html#theRouteEditor">theRouteEditor</a></li><li><a href="global.html#theSphericalTrigonometry">theSphericalTrigonometry</a></li><li><a href="global.html#theTranslator">theTranslator</a></li><li><a href="global.html#theTravelEditor">theTravelEditor</a></li><li><a href="global.html#theTravelNotes">theTravelNotes</a></li><li><a href="global.html#theTravelNotesData">theTravelNotesData</a></li><li><a href="global.html#theTravelNotesToolbarUI">theTravelNotesToolbarUI</a></li><li><a href="global.html#theTravelNotesViewer">theTravelNotesViewer</a></li><li><a href="global.html#theTravelUI">theTravelUI</a></li><li><a href="global.html#theUI">theUI</a></li><li><a href="global.html#theUtilities">theUtilities</a></li><li><a href="global.html#theViewerLayersToolbarUI">theViewerLayersToolbarUI</a></li><li><a href="global.html#theViewerMapEditor">theViewerMapEditor</a></li><li><a href="global.html#theWayPointEditor">theWayPointEditor</a></li></ul>
</nav>

<br class="clear">

<!--footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Thu Jul 08 2021 14:37:09 GMT+0200 (GMT+02:00)
</footer-->
<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
